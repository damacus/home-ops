# =============================================================================
# Kubernetes Required Sysctl Settings
# =============================================================================
# These settings are required for Kubernetes networking.
# Applied at boot via /etc/sysctl.d/
# =============================================================================

# Enable IP forwarding (required for pod networking)
net.ipv4.ip_forward = 1
net.ipv6.conf.all.forwarding = 1

# Enable bridge netfilter (required for iptables to see bridged traffic)
net.bridge.bridge-nf-call-iptables = 1
net.bridge.bridge-nf-call-ip6tables = 1

# Increase inotify limits for large clusters
fs.inotify.max_queued_events = 65536
fs.inotify.max_user_watches = 524288
fs.inotify.max_user_instances = 8192

# Increase file descriptor limits
fs.file-max = 2097152

# Increase ARP cache size for large clusters
net.ipv4.neigh.default.gc_thresh1 = 4096
net.ipv4.neigh.default.gc_thresh2 = 8192
net.ipv4.neigh.default.gc_thresh3 = 16384

# Increase conntrack table size
net.netfilter.nf_conntrack_max = 1048576
