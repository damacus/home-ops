# Ironstone cloud-init configuration
# Use NoCloud datasource with seed files in /var/lib/cloud/seed/nocloud/
datasource_list: [ NoCloud, None ]

# Disable default user creation - we use pi user defined in user-data
users: []

# Override system_info to use pi as default user
system_info:
  default_user:
    name: pi
    groups: [adm, sudo]
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL

# Disable root SSH access
disable_root: true

# K3S data partition (optional, only if partition exists)
fs_setup:
  - label: K3S_DATA
    filesystem: ext4
    device: /dev/disk/by-partlabel/K3S_DATA
    overwrite: false

mounts:
  - [ /dev/disk/by-partlabel/K3S_DATA, /var/lib/rancher ]
